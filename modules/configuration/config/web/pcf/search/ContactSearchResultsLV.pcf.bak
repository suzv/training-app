<?xml version="1.0"?>
<PCF
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="../../../../../pcf.xsd">
  <ListViewPanel
    id="ContactSearchResultsLV">
    <ExposeIterator
      flags="CanDeleteContact,abContact"
      valueType="entity.ABContact"
      widget="ContactSearchResultsLV"/>
    <Require
      name="SearchResults"
      type="gw.api.database.IQueryBeanResult&lt;ABContact&gt;"/>
    <Require
      name="CanPotentiallyDelete"
      type="boolean"/>
    <Require
      name="isSelectMode"
      type="boolean"/>
    <Require
      name="pageHelper"
      type="gw.api.contact.ProximitySearchPageHelper"/>
    <Require
      name="searchCriteria"
      type="ABContactSearchCriteria"/>
    <Require
      name="searchSpec"
      type="gw.api.webservice.addressbook.contactapi.ABContactSearchSpecWithoutPaging"/>
    <Variable
      initialValue="pageHelper.getDrivingDirectionsCache()"
      name="directions"
      type="gw.api.contact.DrivingDirectionsCache"/>
    <RowIterator
      appendPageInfo="true"
      canPick="!CanPotentiallyDelete"
      checkBoxVisible="CanPotentiallyDelete or searchCriteria.isProximitySearch()"
      editable="false"
      elementName="abContact"
      hasCheckBoxes="true"
      pickValue="abContact"
      value="SearchResults"
      valueType="gw.api.database.IQueryBeanResult&lt;entity.ABContact&gt;">
      <ToolbarFlag
        condition="perm.ABContact.delete(abContact)"
        name="CanDeleteContact"/>
      <ToolbarFlag
        name="abContact"/>
      <Row>
        <TextCell
          action="gw.api.web.contact.ABContactUtil.viewContact(isSelectMode, abContact, CurrentLocation)"
          id="DisplayName"
          label="DisplayKey.get(&quot;Web.ContactSearchResults.DisplayName&quot;)"
          sortBy="abContact"
          sortOrder="1"
          value="abContact.DisplayName"/>
        <TypeKeyCell
          id="CreationStatus"
          label="DisplayKey.get(&quot;Web.ContactSearchResults.CreationStatus&quot;)"
          value="abContact.CreateStatus"
          valueType="typekey.ContactCreationApprovalStatus"
          visible="searchSpec.IncludePendingCreates"/>
        <TextCell
          id="Address"
          label="DisplayKey.get(&quot;Web.ContactSearchResults.PrimaryAddress.AddressLine1&quot;)"
          sortBy="abContact.PrimaryAddress.AddressLine1"
          value="abContact.PrimaryAddress.AddressLine1DisplayValue"/>
        <TextCell
          id="City"
          label="DisplayKey.get(&quot;Web.ContactSearchResults.PrimaryAddress.City&quot;)"
          sortBy="abContact.PrimaryAddress.City"
          value="abContact.PrimaryAddress.CityDisplayValue"/>
        <TypeKeyCell
          id="State"
          label="gw.api.address.AddressCountrySettings.getSettings(searchCriteria.Address.Country).StateLabel"
          value="abContact.PrimaryAddress.State"
          valueType="typekey.State"/>
        <TextCell
          id="PostalCode"
          label="gw.api.address.AddressCountrySettings.getSettings(searchCriteria.Address.Country).PostalCodeLabel"
          value="abContact.PrimaryAddress.PostalCode"/>
        <TextCell
          enableSort="false"
          id="PrimaryPhone"
          label="DisplayKey.get(&quot;Web.ContactSearchResults.PrimaryPhone&quot;)"
          value="abContact.PrimaryPhoneValue"/>
        <TypeKeyCell
          id="ContactSubtype"
          label="DisplayKey.get(&quot;Web.ContactSearchResults.ContactSubtype&quot;)"
          value="abContact.Subtype"
          valueType="typekey.ABContact"/>
        <TypeKeyCell
          id="VendorAvailability"
          label="DisplayKey.get(&quot;Web.ContactDetail.VendorAvailability&quot;)"
          value="abContact.VendorAvailability"
          valueType="typekey.VendorAvailabilityType"/>
        <TextCell
          id="Score"
          label="DisplayKey.get(&quot;Web.Reviews.OverallScore&quot;)"
          value="abContact.Score"
          valueType="java.lang.Integer"/>
        <TextCell
          enableSort="false"
          id="GCDistance"
          label="DisplayKey.get(&quot;Web.AddressBook.Search.Result.ProximateDistance&quot;)"
          sortBy="abContact.PrimaryAddress.getDistanceFrom(searchCriteria.ProximitySearchCenter)"
          sortOrder="1"
          value="abContact.PrimaryAddress.getDistanceFromAsString(searchCriteria.ProximitySearchCenter)"
          valueVisible="(abContact.PrimaryAddress != null) and (abContact.PrimaryAddress.hasLocationInformation())"
          visible="searchCriteria.isProximitySearch()"/>
        <TextCell
          enableSort="false"
          id="DrivingDistance"
          label="DisplayKey.get(&quot;Web.AddressBook.Search.Result.DrivingDistance&quot;)"
          value="directions.getCached(searchCriteria.ProximitySearchCenter, abContact.PrimaryAddress).getTotalDistanceString()"
          valueVisible="directions.haveCached(searchCriteria.ProximitySearchCenter, abContact.PrimaryAddress)"
          visible="pageHelper.displayDirectionsColumns(searchCriteria)"/>
        <TextCell
          enableSort="false"
          id="DrivingTime"
          label="DisplayKey.get(&quot;Web.AddressBook.Search.Result.DrivingTime&quot;)"
          value="directions.getCached(searchCriteria.ProximitySearchCenter, abContact.PrimaryAddress).getTotalTimeInMinutes()"
          valueVisible="directions.haveCached(searchCriteria.ProximitySearchCenter, abContact.PrimaryAddress)"
          visible="pageHelper.displayDirectionsColumns(searchCriteria)"/>
        <TextCell
          action="AddressBookDirectionsPopup.push(directions.getCached(searchCriteria.ProximitySearchCenter, abContact.PrimaryAddress))"
          enableSort="false"
          id="Directions"
          label="DisplayKey.get(&quot;Web.AddressBook.Search.Result.Directions&quot;)"
          value="DisplayKey.get(&quot;Web.AddressBook.Search.Result.Directions&quot;)"
          valueVisible="directions.haveCached(searchCriteria.ProximitySearchCenter, abContact.PrimaryAddress)"
          visible="pageHelper.displayDirectionsColumns(searchCriteria)"/>
      </Row>
    </RowIterator>
  </ListViewPanel>
</PCF>